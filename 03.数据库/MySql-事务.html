<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>事务 | Java全栈知识体系</title>
    <meta name="description" content="A VitePress site">
    <meta name="generator" content="VitePress v2.0.0-alpha.12">
    <link rel="preload stylesheet" href="/wiki/assets/style.DEL9oLmP.css" as="style">
    <link rel="preload stylesheet" href="/wiki/vp-icons.css" as="style">
    
    <script type="module" src="/wiki/assets/app.CBjJy-2n.js"></script>
    <link rel="preload" href="/wiki/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/wiki/assets/chunks/theme.DZd7A-GY.js">
    <link rel="modulepreload" href="/wiki/assets/chunks/framework.Dgw6jcLr.js">
    <link rel="modulepreload" href="/wiki/assets/03.数据库_MySql-事务.md.BiJRoRTP.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-1df9f90f><!--[--><!--]--><!--[--><span tabindex="-1" data-v-0b0ada53></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-0b0ada53>Skip to content</a><!--]--><!----><header class="VPNav" data-v-1df9f90f data-v-9f75dce3><div class="VPNavBar" data-v-9f75dce3 data-v-2a96a3d0><div class="wrapper" data-v-2a96a3d0><div class="container" data-v-2a96a3d0><div class="title" data-v-2a96a3d0><div class="VPNavBarTitle has-sidebar" data-v-2a96a3d0 data-v-1e38c6bc><a class="title" href="/wiki/" data-v-1e38c6bc><!--[--><!--]--><!--[--><img class="VPImage logo" src="/wiki/logo.svg" alt data-v-8426fc1a><!--]--><span data-v-1e38c6bc>Java全栈知识体系</span><!--[--><!--]--></a></div></div><div class="content" data-v-2a96a3d0><div class="content-body" data-v-2a96a3d0><!--[--><!--]--><div class="VPNavBarSearch search" data-v-2a96a3d0><!--[--><!----><div id="local-search"><button type="button" aria-label="Search" aria-keyshortcuts="/ control+k meta+k" class="DocSearch DocSearch-Button"><span class="DocSearch-Button-Container"><span class="vpi-search DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key"></kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-2a96a3d0 data-v-39714824><span id="main-nav-aria-label" class="visually-hidden" data-v-39714824> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/wiki/%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%E8%84%9A%E6%89%8B%E6%9E%B6.html" tabindex="0" data-v-39714824 data-v-e56f3d57><!--[--><span data-v-e56f3d57>后台管理系统脚手架</span><!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-39714824 data-v-42cb505d><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-42cb505d><span class="text" data-v-42cb505d><!----><span data-v-42cb505d>JAVA</span><span class="vpi-chevron-down text-icon" data-v-42cb505d></span></span></button><div class="menu" data-v-42cb505d><div class="VPMenu" data-v-42cb505d data-v-25a6cce8><div class="items" data-v-25a6cce8><!--[--><!--[--><div class="VPMenuLink" data-v-25a6cce8 data-v-cd834e02><a class="VPLink link" href="/wiki/01.%E5%90%8E%E7%AB%AF%E6%8A%80%E6%9C%AF%E6%A0%88/JAVA%E5%9F%BA%E7%A1%80.html" data-v-cd834e02><!--[--><span data-v-cd834e02>JAVA基础</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-25a6cce8 data-v-cd834e02><a class="VPLink link" href="/wiki/01.%E5%90%8E%E7%AB%AF%E6%8A%80%E6%9C%AF%E6%A0%88/%E5%A4%9A%E7%BA%BF%E7%A8%8B/JAVA%E5%B9%B6%E5%8F%91-%E7%90%86%E8%AE%BA%E5%9F%BA%E7%A1%80.html" data-v-cd834e02><!--[--><span data-v-cd834e02>多线程</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-39714824 data-v-42cb505d><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-42cb505d><span class="text" data-v-42cb505d><!----><span data-v-42cb505d>Spring全家桶</span><span class="vpi-chevron-down text-icon" data-v-42cb505d></span></span></button><div class="menu" data-v-42cb505d><div class="VPMenu" data-v-42cb505d data-v-25a6cce8><div class="items" data-v-25a6cce8><!--[--><!--[--><div class="VPMenuLink" data-v-25a6cce8 data-v-cd834e02><a class="VPLink link" href="/wiki/02.Spring/Spring-@Transactional%E4%BA%8B%E5%8A%A1%E5%A4%B1%E6%95%88%E7%9A%84%E5%9C%BA%E6%99%AF.html" data-v-cd834e02><!--[--><span data-v-cd834e02>Spring</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-25a6cce8 data-v-cd834e02><a class="VPLink link" href="/wiki/02.Spring/SpringBoot.html" data-v-cd834e02><!--[--><span data-v-cd834e02>SpringBoot</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-39714824 data-v-42cb505d><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-42cb505d><span class="text" data-v-42cb505d><!----><span data-v-42cb505d>数据库</span><span class="vpi-chevron-down text-icon" data-v-42cb505d></span></span></button><div class="menu" data-v-42cb505d><div class="VPMenu" data-v-42cb505d data-v-25a6cce8><div class="items" data-v-25a6cce8><!--[--><!--[--><div class="VPMenuLink" data-v-25a6cce8 data-v-cd834e02><a class="VPLink link" href="/wiki/03.%E6%95%B0%E6%8D%AE%E5%BA%93/MySql-%E7%B4%A2%E5%BC%95.html" data-v-cd834e02><!--[--><span data-v-cd834e02>Mysql</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-25a6cce8 data-v-cd834e02><a class="VPLink link" href="/wiki/03.%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/%E6%A6%82%E5%BF%B5%E5%92%8C%E5%9F%BA%E7%A1%80.html" data-v-cd834e02><!--[--><span data-v-cd834e02>Redis</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-39714824 data-v-42cb505d><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-42cb505d><span class="text" data-v-42cb505d><!----><span data-v-42cb505d>中间件</span><span class="vpi-chevron-down text-icon" data-v-42cb505d></span></span></button><div class="menu" data-v-42cb505d><div class="VPMenu" data-v-42cb505d data-v-25a6cce8><div class="items" data-v-25a6cce8><!--[--><!--[--><div class="VPMenuLink" data-v-25a6cce8 data-v-cd834e02><a class="VPLink link" href="/wiki/04.%E4%B8%AD%E9%97%B4%E4%BB%B6/Kafka.html" data-v-cd834e02><!--[--><span data-v-cd834e02>Kafka</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-25a6cce8 data-v-cd834e02><a class="VPLink link" href="/wiki/04.%E4%B8%AD%E9%97%B4%E4%BB%B6/Zookeeper.html" data-v-cd834e02><!--[--><span data-v-cd834e02>Zookeeper</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-25a6cce8 data-v-cd834e02><a class="VPLink link" href="/wiki/04.%E4%B8%AD%E9%97%B4%E4%BB%B6/Netty.html" data-v-cd834e02><!--[--><span data-v-cd834e02>Netty</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/wiki/03.%E5%B7%A5%E5%85%B7-%E9%83%A8%E7%BD%B2/linux%E8%BF%90%E7%BB%B4%E7%AC%94%E8%AE%B0.html" tabindex="0" data-v-39714824 data-v-e56f3d57><!--[--><span data-v-e56f3d57>工具|部署</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/wiki/06.%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/0-%E7%AE%80%E4%BB%8B.html" tabindex="0" data-v-39714824 data-v-e56f3d57><!--[--><span data-v-e56f3d57>设计模式</span><!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-39714824 data-v-42cb505d><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-42cb505d><span class="text" data-v-42cb505d><!----><span data-v-42cb505d>方法论</span><span class="vpi-chevron-down text-icon" data-v-42cb505d></span></span></button><div class="menu" data-v-42cb505d><div class="VPMenu" data-v-42cb505d data-v-25a6cce8><div class="items" data-v-25a6cce8><!--[--><!--[--><div class="VPMenuLink" data-v-25a6cce8 data-v-cd834e02><a class="VPLink link" href="/wiki/04.%E6%96%B9%E6%B3%95%E8%AE%BA/%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83.html" data-v-cd834e02><!--[--><span data-v-cd834e02>代码规范</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-39714824 data-v-42cb505d><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-42cb505d><span class="text" data-v-42cb505d><!----><span data-v-42cb505d>架构</span><span class="vpi-chevron-down text-icon" data-v-42cb505d></span></span></button><div class="menu" data-v-42cb505d><div class="VPMenu" data-v-42cb505d data-v-25a6cce8><div class="items" data-v-25a6cce8><!--[--><!--[--><div class="VPMenuLink" data-v-25a6cce8 data-v-cd834e02><a class="VPLink link" href="/wiki/05.%E6%9E%B6%E6%9E%84/%E5%B8%B8%E7%94%A8%E6%8A%80%E6%9C%AF%E7%82%B9/JWT.html" data-v-cd834e02><!--[--><span data-v-cd834e02>常用技术点</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-25a6cce8 data-v-cd834e02><a class="VPLink link" href="/wiki/05.%E6%9E%B6%E6%9E%84/%E6%9E%B6%E6%9E%84300%E8%AE%B2.html" data-v-cd834e02><!--[--><span data-v-cd834e02>架构300讲</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/wiki/07.%E4%BB%A3%E7%A0%81%E4%BA%BA%E7%94%9F/%E7%94%9F%E6%B4%BB%E5%B0%8F%E6%8A%80%E5%B7%A7.html" tabindex="0" data-v-39714824 data-v-e56f3d57><!--[--><span data-v-e56f3d57>代码人生</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-2a96a3d0 data-v-6c893767><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-6c893767 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-2a96a3d0 data-v-0394ad82 data-v-d07f11e6><!--[--><a class="VPSocialLink no-icon" href="https://github.com/vuejs/vitepress" aria-label="github" target="_blank" rel="me noopener" data-v-d07f11e6 data-v-591a6b30><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-2a96a3d0 data-v-bb2aa2f0 data-v-42cb505d><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-42cb505d><span class="vpi-more-horizontal icon" data-v-42cb505d></span></button><div class="menu" data-v-42cb505d><div class="VPMenu" data-v-42cb505d data-v-25a6cce8><!----><!--[--><!--[--><!----><div class="group" data-v-bb2aa2f0><div class="item appearance" data-v-bb2aa2f0><p class="label" data-v-bb2aa2f0>Appearance</p><div class="appearance-action" data-v-bb2aa2f0><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-bb2aa2f0 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div></div></div><div class="group" data-v-bb2aa2f0><div class="item social-links" data-v-bb2aa2f0><div class="VPSocialLinks social-links-list" data-v-bb2aa2f0 data-v-d07f11e6><!--[--><a class="VPSocialLink no-icon" href="https://github.com/vuejs/vitepress" aria-label="github" target="_blank" rel="me noopener" data-v-d07f11e6 data-v-591a6b30><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-2a96a3d0 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-2a96a3d0><div class="divider-line" data-v-2a96a3d0></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-1df9f90f data-v-8acdfeb5><div class="container" data-v-8acdfeb5><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-8acdfeb5><span class="vpi-align-left menu-icon" data-v-8acdfeb5></span><span class="menu-text" data-v-8acdfeb5>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-8acdfeb5 data-v-0bf0e06f><button data-v-0bf0e06f>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-1df9f90f data-v-e7c6e512><div class="curtain" data-v-e7c6e512></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-e7c6e512><span class="visually-hidden" id="sidebar-aria-label" data-v-e7c6e512> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-8d50c081><section class="VPSidebarItem level-0 has-active" data-v-8d50c081 data-v-d81de50c><div class="item" role="button" tabindex="0" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><h2 class="text" data-v-d81de50c>数据库</h2><!----></div><div class="items" data-v-d81de50c><!--[--><section class="VPSidebarItem level-1 has-active" data-v-d81de50c data-v-d81de50c><div class="item" role="button" tabindex="0" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><h3 class="text" data-v-d81de50c>Mysql</h3><!----></div><div class="items" data-v-d81de50c><!--[--><div class="VPSidebarItem level-2 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/wiki/03.%E6%95%B0%E6%8D%AE%E5%BA%93/MySql-%E7%B4%A2%E5%BC%95.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>索引</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/wiki/03.%E6%95%B0%E6%8D%AE%E5%BA%93/MySql-%E4%BA%8B%E5%8A%A1.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>事务</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/wiki/03.%E6%95%B0%E6%8D%AE%E5%BA%93/MySql-SQL%E4%BC%98%E5%8C%96.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>SQL优化</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/wiki/03.%E6%95%B0%E6%8D%AE%E5%BA%93/MySql-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E7%9A%84%E5%8E%9F%E7%90%86.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>主从复制的原理</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/wiki/03.%E6%95%B0%E6%8D%AE%E5%BA%93/MySql-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E6%95%B0%E6%8D%AE%E4%B8%80%E8%87%B4%E6%80%A7.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>主从复制数据一致性</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/wiki/03.%E6%95%B0%E6%8D%AE%E5%BA%93/MySql-%E5%85%A8%E5%B1%80ID.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>分库分表全局ID</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/wiki/03.%E6%95%B0%E6%8D%AE%E5%BA%93/MySql-%E6%B7%B1%E5%BA%A6%E5%88%86%E9%A1%B5.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>深度分页limit</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/wiki/03.%E6%95%B0%E6%8D%AE%E5%BA%93/MySql-%E5%A4%A7%E5%8E%82%E5%AE%9E%E8%B7%B5-%E7%BE%8E%E5%9B%A2MySQL%E7%B4%A2%E5%BC%95%E5%8E%9F%E7%90%86%E5%8F%8A%E6%85%A2%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>大厂实践:美团MySQL索引原理及慢查询优化</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/wiki/03.%E6%95%B0%E6%8D%AE%E5%BA%93/MySql-%E5%A4%A7%E5%8E%82%E5%AE%9E%E8%B7%B5-%E7%BE%8E%E5%9B%A2SQL%E4%BC%98%E5%8C%96%E5%B7%A5%E5%85%B7SQLAdvisor%E5%BC%80%E6%BA%90.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>大厂实践:美团SQL优化工具SQLAdvisor开源</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1" data-v-d81de50c data-v-d81de50c><div class="item" role="button" tabindex="0" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><h3 class="text" data-v-d81de50c>Redis</h3><!----></div><div class="items" data-v-d81de50c><!--[--><div class="VPSidebarItem level-2 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/wiki/03.%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/%E6%A6%82%E5%BF%B5%E5%92%8C%E5%9F%BA%E7%A1%80.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>概念和基础</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/wiki/03.%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E5%AF%B9%E8%B1%A1%E6%9C%BA%E5%88%B6.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>数据结构-对象机制</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/wiki/03.%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E5%BA%95%E5%B1%82%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>数据结构-底层数据结构</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/wiki/03.%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E5%AF%B9%E8%B1%A1%E4%B8%8E%E7%BC%96%E7%A0%81(%E5%BA%95%E5%B1%82%E7%BB%93%E6%9E%84).html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>数据结构-对象与编码(底层结构)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/wiki/03.%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/%E6%8C%81%E4%B9%85%E5%8C%96RDB%E5%92%8CAOP.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>持久化RDB和AOF</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/wiki/03.%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/%E9%AB%98%E5%8F%AF%E7%94%A8-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>高可用-主从复制</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/wiki/03.%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/%E9%AB%98%E5%8F%AF%E7%94%A8-%E5%93%A8%E5%85%B5%E6%9C%BA%E5%88%B6.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>高可用-哨兵机制</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/wiki/03.%E6%95%B0%E6%8D%AE%E5%BA%93/Redis/%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>性能调优</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/wiki/03.%E6%95%B0%E6%8D%AE%E5%BA%93/Redis.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>Redis相关问题</p><!--]--></a><!----></div><!----></div><!--]--></div></section><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/wiki/03.%E6%95%B0%E6%8D%AE%E5%BA%93/Mysql%E5%92%8CRedis%E6%95%B0%E6%8D%AE%E4%B8%80%E8%87%B4%E6%80%A7.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>Mysql和Redis数据一致性</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/wiki/03.%E6%95%B0%E6%8D%AE%E5%BA%93/Kafka.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>Kafka</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/wiki/03.%E6%95%B0%E6%8D%AE%E5%BA%93/Zookeeper.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>Zookeeper</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/wiki/03.%E6%95%B0%E6%8D%AE%E5%BA%93/Netty.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>Netty</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-1df9f90f data-v-aff0b8d7><div class="VPDoc has-sidebar has-aside" data-v-aff0b8d7 data-v-7011f0d8><!--[--><!--]--><div class="container" data-v-7011f0d8><div class="aside" data-v-7011f0d8><div class="aside-curtain" data-v-7011f0d8></div><div class="aside-container" data-v-7011f0d8><div class="aside-content" data-v-7011f0d8><div class="VPDocAside" data-v-7011f0d8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-3f215769 data-v-60d5052e><div class="content" data-v-60d5052e><div class="outline-marker" data-v-60d5052e></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-60d5052e>On this page</div><ul class="VPDocOutlineItem root" data-v-60d5052e data-v-2d0bdf9b><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-7011f0d8><div class="content-container" data-v-7011f0d8><!--[--><!--]--><main class="main" data-v-7011f0d8><div style="position:relative;" class="vp-doc _wiki_03_%E6%95%B0%E6%8D%AE%E5%BA%93_MySql-%E4%BA%8B%E5%8A%A1" data-v-7011f0d8><div><h1 id="事务" tabindex="-1">事务 <a class="header-anchor" href="#事务" aria-label="Permalink to “事务”">​</a></h1><h2 id="说说什么是事务" tabindex="-1">说说什么是事务 <a class="header-anchor" href="#说说什么是事务" aria-label="Permalink to “说说什么是事务”">​</a></h2><p><a href="https://www.cnblogs.com/binghe001/p/13620501.html" target="_blank" rel="noreferrer">https://www.cnblogs.com/binghe001/p/13620501.html</a></p><p>本质考察：事务的四大特性</p><p>事务：单个逻辑工作单元组成的一系列操作，要么全部执行，要么全部不不执行。一个逻辑工作单元要成为事务，必须满足所谓的ACID（原子性、一致性、隔离性、持久性）属性。</p><ul><li>A：原子性（Atomicity）： 事务中的所有操作要么全部执行成功，要么全部失败回滚，不能只执行其中一部分操作。</li><li>C：一致性（Consistency）：事务执行前后，数据库的完整性约束没有被破坏，数据总是从一个一致性状态转移到另一个一致性状态。例如，如果一个事务要求将某个账户的金额从 A 转移到 B，那么无论事务是否成功，最终账户 A 和账户 B 的总金额应该保持不变。</li><li>I：隔离性（Isolation）： 事务之间是相互隔离的，每个事务对其他事务的操作是透明的，一个事务的中间结果对其他事务是不可见的。隔离性可以防止并发执行的事务之间产生脏读、不可重复读和幻读等问题。</li><li>D：持久性（Durability）： 事务完成后，对数据库的修改将永久保存在数据库中，即使系统故障也不会丢失。</li></ul><h2 id="如何保证事务的四大特性" tabindex="-1">如何保证事务的四大特性？ <a class="header-anchor" href="#如何保证事务的四大特性" aria-label="Permalink to “如何保证事务的四大特性？”">​</a></h2><p>以默认的引擎 InnoDB 为例，它保证四大特性的手段分别是：</p><ol><li>原子性是通过 undo log（回滚日志） 来保证的，InnoDB 使用日志（undo log）来记录事务的操作，包括事务开始、修改数据和事务提交等。如果事务执行失败或回滚，InnoDB 可以使用日志来撤销已经执行的操作，确保事务的原子性。</li><li>一致性：更多是依赖业务层。数据库是通过各种约束，如主键、外键、唯一性约束等。</li><li>隔离性：提供了4种隔离级别，默认隔离级别是RR（可重复读），是通过 MVCC（多版本并发控制）解决了脏读和不可重复读的问题， 锁机制（表锁和行锁）的方式解决幻读的问题。</li><li>持久性：是通过 redo log （重做日志）来保证的，在事务提交之前，InnoDB 会将事务的修改操作先写入事务日志（redo log），然后再将数据写入磁盘。即使在系统崩溃或断电的情况下，InnoDB 可以通过重放事务日志来恢复数据，确保事务的持久性。由<code>Buffer Pool缓冲区</code>+redo log来保证，mysql修改数据同时在内存和redo log记录这次操作，事务提交的时候通过redo log刷盘，宕机的时候可以从redo log恢复</li></ol><h2 id="并发事务带来的问题-隔离级别" tabindex="-1">并发事务带来的问题|隔离级别 <a class="header-anchor" href="#并发事务带来的问题-隔离级别" aria-label="Permalink to “并发事务带来的问题|隔离级别”">​</a></h2><p>本质考察：带来哪些问题，有哪些解决方案</p><p>带来的问题：</p><ul><li>脏写：多个事务对数据进行更新，互相不知道对方的存在， 最后的更新将重写由其它事务所做的更新，这将导致数据丢失。</li><li>脏读：一个事务在更新时，在完成提交前，另一个事务读取同一条数据，如果不加控制，第二条事务就读到了“脏”数据， 并据此做进一步的处理，就会产生未提交的数据依赖关系。这种现象被形象地叫做”脏读” 。</li><li>不可重复读： 同一个事务中，不同时间读取到的数据可能不一样。</li><li>幻读： 即在一个事务中，两次查询同一个范围的记录，但第二次查询却发现了新的记录。</li></ul><p>问题的解决方案：</p><p>为避免上面出现的几种情况，在标准SQL规范中，定义了4个事务隔离级别，不同的隔离级别对事务的处理不同。以下4种隔离级别限制从低到高，性能从高到低。高度隔离会限制可并行执行的事务数，所以一些应用程序降低隔离级别以换取更大的吞吐量。</p><ul><li><strong>读未提交（Read Uncommitted）</strong></li></ul><p>允许脏读，但不允许更新丢失，一个事务写时，不允许其他事务写，可以读。该隔离级别可通过“排他写锁”实现。</p><ol><li>特点：最低的隔离级别，事务中的修改，即使未提交，也可以被其他事务读取到。</li><li>优点：并发性能最好，读取到的数据最新。</li><li>缺点：<strong>存在脏读（Dirty Read）问题</strong>，即读取到未提交的数据，可能导致数据不一致性</li></ol><ul><li><strong>读已提交（Read Committed）</strong></li></ul><p>这可以通过“瞬间共享读锁”和“排他写锁”实现 。 可避免 脏读，不可避免 不可重复读、虚读。Oracle采用读已提交。</p><ol><li>特点：保证事务读取到的数据都是已经提交的，其他事务提交的数据对该事务可见。</li><li>优点：避免了脏读的问题。</li><li>缺点：<strong>存在不可重复读（Non-Repeatable Read）问题</strong>，即同一个事务中，不同时间读取到的数据可能不一样。</li></ol><ul><li><strong>可重复读（Repeatable Read）</strong></li></ul><p>可避免脏读、不可重复读， 不可避免 虚读。MySQL采用可重复读。</p><ol><li>特点：保证同一个事务中，多次读取同一条记录时，读取到的数据都是一致的，MySQL 默认的事务隔离级别。</li><li>优点：避免了不可重复读的问题。</li><li>缺点：<strong>存在幻读（Phantom Read）问题</strong>，即在一个事务中，两次查询同一个范围的记录，但第二次查询却发现了新的记录。</li></ol><ul><li><strong>串行化（Serializable）</strong></li></ul><p>可避免 脏读、不可重复读、幻读情况的发生。</p><p>特点：最高的隔离级别，将所有的事务串行执行，保证了数据的完全隔离。</p><p>优点：避免了幻读的问题。</p><p>缺点：<strong>并发性能最差</strong>，可能导致大量的锁等待和死锁。</p><p>通常情况下，可重复读是一个比较好的选择，能够较好地平衡数据一致性和并发性能。</p><h2 id="不可重复读和幻读有什么区别" tabindex="-1">不可重复读和幻读有什么区别 <a class="header-anchor" href="#不可重复读和幻读有什么区别" aria-label="Permalink to “不可重复读和幻读有什么区别”">​</a></h2><ol><li><p>发生场景不同</p><p>：不可重复读主要涉及到修改数据，而幻读则主要涉及到插入或删除数据。</p><ol><li>不可重复读指的是在同一个事务中，多次读取同一行数据，但是每次读取的结果都不同，这是因为在这个事务读取数据的期间，其他事务修改了这些数据所导致的；</li><li>幻读指的是在同一个事务中，多次执行相同的查询，但是每次查询返回的行数却不同，这是因为在这个事务读取数据的期间，其他事务插入了新的数据所导致的。</li></ol></li><li><p><strong>解决方案不同</strong>：不可重复读的解决方案通常是使用行锁或者表锁来解决，而幻读的解决方案通常是使用间隙锁来解决。</p></li></ol><p>所以，不可重复读主要涉及到修改数据，而幻读则主要涉及到插入或删除数据。同时，不可重复读的解决方案通常是使用行锁或者表锁，而幻读的解决方案通常是使用间隙锁。</p><h2 id="rr有幻读问题么-mvcc能否解决幻读" tabindex="-1">RR有幻读问题么？MVCC能否解决幻读？ <a class="header-anchor" href="#rr有幻读问题么-mvcc能否解决幻读" aria-label="Permalink to “RR有幻读问题么？MVCC能否解决幻读？”">​</a></h2><p><strong>RR 隔离级别</strong></p><p>在 MySQL 中，RR 代表 Repeatable Read（可重复读），是数据库事务隔离级别中的一种，它的特性是保证同一个事务中，多次读取同一条记录时，读取到的数据都是一致的。它也是 MySQL 默认的事务隔离级别。</p><blockquote><p>隔离级别是数据库管理系统为了处理并发访问时，控制事务之间相互影响的程度而定义的一组规则。</p></blockquote><p><strong>MVCC</strong></p><p>MVCC（Multi-Version Concurrency Control，多版本并发控制）是一种并发控制机制，用于在数据库系统中处理并发读写操作时保持数据的一致性和隔离性（<strong>主要是用来解决幻读问题的</strong>）。MVCC 通过在每个数据行上保存多个版本的数据来实现并发读取和写入的一致性。</p><p>MVCC 的核心思想是将每个事务的读操作与写操作解耦，通过保存数据的历史版本来实现并发控制。每个事务在开始时会创建一个读视图（Read View），用于确定在事务开始时可见的数据版本。读视图包含一个事务开始时的系统版本号，用于与数据行的版本号进行比较，以确定数据行是否对事务可见。</p><p>在 MVCC 中，当一个事务执行写操作时，会生成一个新的数据版本，并将旧版本的数据保存在回滚日志（Undo Log）中。这样，其他事务在读取数据时仍然可以访问到旧版本的数据，从而避免了幻读问题。</p><p>MVCC 工作流程如下：</p><ol><li>读操作：当一个事务执行 SELECT 语句时，会根据读视图的系统版本号和数据行的版本号进行比较，只读取在事务开始之前已经提交的数据行。这样，即使其他事务正在并发地插入或删除数据，事务仍然可以读取到一致的数据。</li><li>写操作：当一个事务执行 INSERT、UPDATE 或 DELETE 语句时，会生成新的数据版本，并将旧版本的数据保存在回滚日志中。这样，其他事务在读取数据时仍然可以访问到旧版本的数据，从而避免了幻读问题。</li></ol><p>MVCC 机制在数据库系统中广泛应用，特别是在支持事务的存储引擎中，如 MySQL 的 InnoDB 引擎。它通过解耦读操作和写操作，提供了高并发性能和数据一致性，使得多个事务可以同时读取和修改数据库，而不会相互干扰。</p><h3 id="rr-mvcc-有幻读问题吗" tabindex="-1">RR + MVCC 有幻读问题吗？ <a class="header-anchor" href="#rr-mvcc-有幻读问题吗" aria-label="Permalink to “RR + MVCC 有幻读问题吗？”">​</a></h3><p>在 MySQL 中，即使是<strong>RR 隔离级别（可重复读），虽然它通过 MVCC 消除了绝大部分幻读问题，但依旧存在部分幻读问题</strong>，所以 RR 隔离级别存在幻读问题，而 MVCC 也没有彻底解决幻读问题。</p><h3 id="幻读问题演示" tabindex="-1">幻读问题演示 <a class="header-anchor" href="#幻读问题演示" aria-label="Permalink to “幻读问题演示”">​</a></h3><p>在 RR 隔离级别中存在两种读操作：</p><ol><li><strong>快照读</strong>：数据库中一种读取数据的方式，它基于事务开始时的一个一致性快照来读取数据。快照读可以提供事务开始时的数据视图，即使在事务执行期间其他事务对数据进行了修改，也不会影响快照读取到的数据。简单理解，快照读就是事务开启时创建一个缓存，之后的查询都会从这个缓存中获取数据。</li><li><strong>当前读</strong>：数据库中一种读取数据的方式，它读取最新提交的数据，而不是基于事务开始时的一致性快照。</li></ol><p>所以，在 RR 隔离级别中 MVCC 通过快照读的方式解决了大部分幻读问题，但如果 RR 隔离级别存在当前读（使用 select ... for update 实现），那么此时也会发生幻读问题，比如以下执行过程：</p><p><img src="/wiki/images/03%E6%95%B0%E6%8D%AE%E5%BA%93/mvcc1.png" alt=""></p><h3 id="如何彻底解决幻读" tabindex="-1">如何彻底解决幻读？ <a class="header-anchor" href="#如何彻底解决幻读" aria-label="Permalink to “如何彻底解决幻读？”">​</a></h3><p>想要彻底解决幻读问题，有两个方案：</p><ol><li><p><strong>使用串行化（Serializable）隔离级别</strong>：官方推荐方案，但这种解决方案，并发性能比较低。</p></li><li><p><strong>RR + 锁</strong>：使用 RR 隔离级别，但在事务开启之后立即加锁，如下图所示：</p><p><img src="/wiki/images/03%E6%95%B0%E6%8D%AE%E5%BA%93/mvcc2.png" alt=""></p><p>事务一开启之后就加锁，之后其他事务在操作此表的相关数据时，就只能等待锁释放（事务一提交或回滚锁自动释放）。</p></li></ol><h2 id="行锁、表锁和间隙锁有什么区别" tabindex="-1">行锁、表锁和间隙锁有什么区别 <a class="header-anchor" href="#行锁、表锁和间隙锁有什么区别" aria-label="Permalink to “行锁、表锁和间隙锁有什么区别”">​</a></h2><p>行锁、表锁和间隙锁是 InnoDB 中实现事务隔离级别的基本锁类型。</p><ul><li>行锁：指对表中的某一行数据进行锁定，当有事务修改该行数据时，其他事务无法同时修改该行数据，从而保证数据的一致性。行锁的粒度最细，对并发性能的影响最小。</li><li>表锁：指对整张表进行锁定，当有事务对表中任意一行数据进行修改时，其他事务无法修改整张表中的任意一行数据，从而保证数据的一致性。表锁的粒度最大，对并发性能的影响最大。</li><li>间隙锁：指对一个索引范围中的“空隙”进行锁定，防止其他事务在这个范围内插入新数据。间隙锁用于解决幻读问题，例如在某个事务中执行了一个范围查询，然后在范围内的间隙处插入了新数据，这时再次执行相同的查询，会发现有一些行出现了两次，这就是幻读。通过间隙锁，可以防止其他事务插入新的数据，从而避免幻读。</li><li>临建锁是行锁和间隙锁的组合，可以理解为一种特殊的间隙锁，它等于行锁+间隙锁，除了锁住记录本身，还会锁住索引之间的间隙，即锁定一段左开右闭的索引区间。</li></ul><p>在 InnoDB 中，默认情况下是使用行锁实现事务隔离级别的。当需要锁定一整张表时，可以使用表锁；当需要解决幻读问题时，可以使用间隙锁。在使用间隙锁时，需要注意锁的范围，避免影响其他事务的正常操作。</p><h3 id="锁示例" tabindex="-1">锁示例 <a class="header-anchor" href="#锁示例" aria-label="Permalink to “锁示例”">​</a></h3><p>以下是一个示例，演示如何使用行锁、表锁和间隙锁。</p><p><strong>1.行锁</strong></p><p>行锁是在数据行级别上实现的锁，它可以防止多个事务同时修改同一行数据。下面是一个示例：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 会话 1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BEGIN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> orders </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FOR</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> UPDATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 对 id=1 的数据行进行修改</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">UPDATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> orders </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SET</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> amount </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> amount </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">COMMIT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 会话 2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BEGIN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 因为会话 1 对 id=1 的数据行进行了行锁，所以会话 2 不能同时对该行进行修改，</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 如果执行下面的语句会一直等待会话 1 的事务提交或回滚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">UPDATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> orders </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SET</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> amount </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> amount </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 50</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p><strong>2.表锁</strong></p><p>表锁是在表级别上实现的锁，它可以防止多个事务同时修改整个表。下面是一个示例：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 会话 1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BEGIN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LOCK TABLES orders WRITE;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 对整个表进行修改</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">UPDATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> orders </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SET</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> amount </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> amount </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">COMMIT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">UNLOCK</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TABLES;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 会话 2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BEGIN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 因为会话 1 对 orders 表进行了表锁，所以会话 2 不能同时对该表进行修改，</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 如果执行下面的语句会一直等待会话 1 的事务提交或回滚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">UPDATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> orders </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SET</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> amount </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> amount </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><p><strong>3.间隙锁</strong></p><p>间隙锁是在索引上实现的锁，它可以防止其他事务插入数据到锁定的范围内。下面是一个示例：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 会话 1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BEGIN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 对 id 大于 1 小于 10 的范围进行间隙锁定</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> orders </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> AND</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FOR</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> UPDATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 间隙锁会阻止其他事务在 id 大于 1 小于 10 的范围内插入数据，</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 但允许其他事务在该范围之外的位置插入数据</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">COMMIT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 会话 2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BEGIN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 因为会话 1 对 id 大于 1 小于 10 的范围进行了间隙锁定，所以会话 2 不能在该范围内插入数据，</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 如果执行下面的语句会一直等待会话 1 的事务提交或回滚</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INSERT INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> orders (id, amount) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VALUES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">500</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><h2 id="说一说mvcc的执行原理" tabindex="-1">说一说MVCC的执行原理 <a class="header-anchor" href="#说一说mvcc的执行原理" aria-label="Permalink to “说一说MVCC的执行原理”">​</a></h2><p>MVCC（Multi-Version Concurrency Control）是一种并发控制机制，用于解决数据库并发访问中，数据一致性问题。它通过在读写操作期间保存多个数据版本，以提供并发事务间的隔离性，从而避免了传统的锁机制所带来的资源争用和阻塞问题。</p><blockquote><p>所谓的一致性问题，就是在并发事务执行时，应该看到那些数据和不应该看到那些数据。</p></blockquote><p>在 MVCC 机制中，每个事务的读操作都能看到事务开始之前的一致性数据快照，而不受其他并发事务的修改的影响。核心思想是<strong>通过创建多个数据版本，保持事务的一致性和隔离性</strong>。</p><p>使用 MVCC 机制解决了 RR 隔离级别中，部分幻读问题，但又没把全部幻读问题都解决。</p><ul><li>MVCC 解决了 RR 隔离级别中，快照读的幻读问题。多次查询快照读时，因为 RR 级别是复用 Read View（读视图），所以没有幻读问题。</li><li>但 MVCC 解决不了 RR 隔离级别中，如果遇到快照读和当前读（读取当前最新的数据）中间发生过添加操作，那么 Read View 不能复用，就出现了幻读的问题。</li></ul><p><strong>快照读和当前读</strong></p><p><strong>快照读</strong>：是指在一个事务中，读取的数据版本是在事务开始时已经存在的数据版本，而不是最新的数据版本。这种读取方式提供了事务在执行期间看到的数据视图的一致性，<strong>select 查询就是快照读</strong>。</p><p><strong>当前读</strong>：是指在事务中读取最新的数据版本，以下几种操作都是当前读：</p><ul><li>select ... for update;</li><li>select ... lock in share mode;</li><li>insert ...</li><li>update ...</li><li>delete ...</li></ul><h3 id="mvcc-实现原理" tabindex="-1"><strong>MVCC 实现原理</strong> <a class="header-anchor" href="#mvcc-实现原理" aria-label="Permalink to “MVCC 实现原理”">​</a></h3><p>MVCC 主要是依靠以下两部分实现的：</p><ol><li>隐藏字段：每个执行的 SQL 命令都有几个隐藏的字段，其中有一个事务 ID 字段，很重要。</li><li>Undo Log 链： 里面记录了 SQL 命令执行的历史数据 。</li><li>Read View（读视图或者叫一致性视图）： 包含快照读（一个快照，保存了数据库某个时刻的数据）和一些重要的属性。</li></ol><p>它的实现原理简单来说，是通过 SQL 中隐藏的字段事务 ID（自己的版本号）和 Read View 中的属性版本号进行对比，对比之后决定使用 Read View 中的快照或 undo log 中的历史数据（对比的规则是 MVCC 机制的规定，本文不展开讨论），最后再将符合的数据返回。</p><p><strong>Undo Log 链</strong></p><p>我们知道 Undo Log 主要是用于数据库中事务回滚的，但在 MVCC 机制中也发挥着重要的作用，那什么是 Undo Log 链呢？</p><p>Undo Log 链是指在每个数据对象上维护的 Undo Log 记录链表。每张表都会有与之相对应的 Undo Log 链，用于记录修改前的数据信息（以方便数据进行回滚）。</p><p><img src="/wiki/images/03%E6%95%B0%E6%8D%AE%E5%BA%93/undo-log.png" alt=""></p><p><strong>Read View</strong></p><p>Read View（读视图）用于管理事务之间数据可见性的一种机制。Read View 在特定时刻为事务创建的一个快照，该快照包含了在该时刻所有未提交事务的事务标识符，以及其他一些辅助信息。</p><p>在 Read View 中包含了以下 4 个主要的字段：</p><ol><li>m_ids：当前活跃的事务编号集合。</li><li>min_trx_id：最小活跃事务编号。</li><li>max_trx_id：预分配事务编号，当前最大事务编号+1。</li><li>creator_trx_id：ReadView 创建者的事务编号。</li></ol><p>RC 级别中，每次快照读都会生成一个全新的 Read View，而 RR 级别中同一个事务会复用一个 Read View。</p><p>有了 Read View 和 Undo Log 链之后，并发事务在查询时就知道要读取那些数据了。</p><p><strong>判断方法</strong></p><p>判断方法是根据 Read View 中的 4 个重要字段，先去 Undo Log 中最新的数据行进行比对，如果满足下面 Read View 的判断条件，则返回当前行的数据，如果不满足则继续查找 Undo Log 的下一行数据，直到找到满足的条件的数据为止，如果查询完没有满足条件的数据，则返回 NULL。</p><p><strong>判断规则</strong></p><ol><li><p><strong>trx_id==creator_trx_id</strong>：先将 Undo Log 最新数据行中的 trx_id 和 ReadView 中的 creator_trx_id 进行对比，如果他们两个值相同，则说明是在同一个事务中执行，那么直接返回当前 Undo Log 的数据行即可，如果不相等，则继续下面流程。</p></li><li><p>**trx_id：如果 trx_id 小于 min_trx_id，则说明在执行查询时，其他事务已经提交此行数据了，那么直接返回此行数据即可，如果大于等于，则继续下面流程。</p></li><li><p><strong>trx_id&gt;max_trx_id</strong>：如果 trx_id 如果大于等于 max_trx_id，则说明该行数据比当前操作执行的晚，当前行数据不可见，继续执行后续流程。</p></li><li><p>min_trx_id&lt;=trx_id&lt;max_trx_id</p><p>：trx_id 在 min_trx_id 和 max_trx_id 之间还分为以下两种情况：</p><ol><li><strong>trx_id 在 m_ids 中</strong>：说明事务尚未执行完，该行数据不可被访问。</li><li><strong>trx_id 未在 m_ids 中</strong>：说明事务已经执行完，可以返回该行数据。</li></ol></li></ol><p>以上判断规则从 Undo Log 最新的行数据，逐行对比，直到找到匹配的数据，否则查询完未匹配上，则返回 NULL。</p><p><strong>小结</strong></p><p>MVCC 的实现主要依赖读视图 Read View 和 Undo Log 链，通过 Read View 中的 4 个字段，判断要读取 Undo Log 中数据，从而解决了数据库并发访问中，数据一致性的问题。</p><blockquote><p>MVCC 主要应用于 InnoDB 引擎中的 RC 事务隔离级别和 RR 隔离级别，其中 RC 隔离级别每次快照读都会生成一个新的 Read View，而 RR 隔离级别只在第一次快照读时生成 Read View，之后会复用 Read View，从而解决了（部分）幻读问题。</p></blockquote></div></div></main><footer class="VPDocFooter" data-v-7011f0d8 data-v-e257564d><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-e257564d><span class="visually-hidden" id="doc-footer-aria-label" data-v-e257564d>Pager</span><div class="pager" data-v-e257564d><a class="VPLink link pager-link prev" href="/wiki/03.%E6%95%B0%E6%8D%AE%E5%BA%93/MySql-%E7%B4%A2%E5%BC%95.html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>Previous page</span><span class="title" data-v-e257564d>索引</span><!--]--></a></div><div class="pager" data-v-e257564d><a class="VPLink link pager-link next" href="/wiki/03.%E6%95%B0%E6%8D%AE%E5%BA%93/MySql-SQL%E4%BC%98%E5%8C%96.html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>Next page</span><span class="title" data-v-e257564d>SQL优化</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"01.后端技术栈_java基础.md\":\"QC5wiYMk\",\"01.后端技术栈_java基础2.md\":\"KdEV7wBO\",\"01.后端技术栈_jdk8-21.md\":\"QVyqOpOg\",\"01.后端技术栈_多线程_java并发-threadlocal.md\":\"jIJjlyCs\",\"01.后端技术栈_多线程_java并发-理论基础.md\":\"DjL0Ykzi\",\"01.后端技术栈_多线程_juc线程池-completablefuture.md\":\"2f3UTrcW\",\"01.后端技术栈_多线程_juc线程池-threadpoolexecutor.md\":\"BMXbVa0f\",\"01.后端技术栈_多线程_juc集合-blockingqueue.md\":\"BiVFYqeR\",\"01.后端技术栈_多线程_关键字final.md\":\"WwMbTa5r\",\"01.后端技术栈_多线程_关键字synchronized.md\":\"BmtMCKCN\",\"01.后端技术栈_多线程_关键字volatile.md\":\"DjIaiIau\",\"01.后端技术栈_算法.md\":\"C2jZqr12\",\"01.后端技术栈_网络io.md\":\"CbK-uhLH\",\"02.spring_spring-@transactional事务失效的场景.md\":\"CnC9ehpY\",\"02.spring_spring.md\":\"C9GQbSbE\",\"02.spring_springboot.md\":\"De9jTNfW\",\"02.spring_springcloud.md\":\"DSARoEIO\",\"02.前端技术栈_html.md\":\"CMfWgYXj\",\"02.前端技术栈_javascript.md\":\"De4l4jUj\",\"02.算法_算法基础和思想_数据结构基础_数据结构基础概述.md\":\"B_8s5pyR\",\"02.算法_算法基础和思想_数据结构基础_线性表-数组和矩阵.md\":\"B7qZ_6Wy\",\"02.算法_算法基础和思想_数据结构基础_线性表-链表.md\":\"B9a6smwE\",\"03.工具-部署_linux运维笔记.md\":\"B2GbAGTy\",\"03.工具-部署_window.md\":\"BIYzglmB\",\"03.工具-部署_工具-部署.md\":\"DsYv9u8n\",\"03.工具-部署_常见单词.md\":\"C8HuqWYi\",\"03.工具-部署_收藏目录.md\":\"ByVpw9Qb\",\"03.数据库_kafka.md\":\"BixfX6Ol\",\"03.数据库_mysql-sql优化.md\":\"BB6AlTys\",\"03.数据库_mysql-主从复制数据一致性.md\":\"DlKEROeg\",\"03.数据库_mysql-主从复制的原理.md\":\"gW_L-Vb1\",\"03.数据库_mysql-事务.md\":\"BiJRoRTP\",\"03.数据库_mysql-全局id.md\":\"CIx_qjLt\",\"03.数据库_mysql-大厂实践-美团mysql索引原理及慢查询优化.md\":\"C57gkC6R\",\"03.数据库_mysql-大厂实践-美团sql优化工具sqladvisor开源.md\":\"DRTrJthL\",\"03.数据库_mysql-深度分页.md\":\"Dbu2upTc\",\"03.数据库_mysql-索引.md\":\"JaoQi9o5\",\"03.数据库_mysql和redis数据一致性.md\":\"DOMqrS5l\",\"03.数据库_netty.md\":\"C-Y4GtZM\",\"03.数据库_redis.md\":\"CVraal22\",\"03.数据库_redis_性能调优.md\":\"BBaf_CMd\",\"03.数据库_redis_持久化rdb和aop.md\":\"CdQIriis\",\"03.数据库_redis_数据结构-对象与编码(底层结构).md\":\"DFeBrzVO\",\"03.数据库_redis_数据结构-对象机制.md\":\"CCMgM2xY\",\"03.数据库_redis_数据结构-底层数据结构.md\":\"CZjK2meg\",\"03.数据库_redis_概念和基础.md\":\"C0HsGHnY\",\"03.数据库_redis_高可用-主从复制.md\":\"DXpC-41k\",\"03.数据库_redis_高可用-哨兵机制.md\":\"_AzYX09P\",\"03.数据库_zookeeper.md\":\"DyjSpJbY\",\"04.中间件_kafka.md\":\"D-tI2eJk\",\"04.中间件_netty.md\":\"CFcZ2hw2\",\"04.中间件_zookeeper.md\":\"LMlbq6Tb\",\"04.方法论_代码规范.md\":\"Bzs_jHHs\",\"04.方法论_开发流程.md\":\"CVEDR5zS\",\"05.架构_常用技术点_jwt.md\":\"DvA3pYeG\",\"05.架构_常用技术点_数据库读写分离.md\":\"CsuSSDlg\",\"05.架构_架构300讲.md\":\"DZm2h1HD\",\"05.架构_架构900讲_01通用性架构.md\":\"DpuCOM-h\",\"05.架构_架构900讲_mq.md\":\"lI5JoVAY\",\"05.架构_架构900讲_redis.md\":\"DEP7N8f0\",\"05.架构_架构900讲_数据库-mysql.md\":\"BB3xfgRd\",\"05.架构_架构900讲_数据库.md\":\"DZp5n7ge\",\"05.架构_架构900讲_运维.md\":\"DCQHio2F\",\"06.设计模式_0-简介.md\":\"BlC2pYvN\",\"06.设计模式_1-单例模式.md\":\"u0nTY7eS\",\"06.设计模式_10-桥接模式.md\":\"Ccp8R_qu\",\"06.设计模式_11-组合模式.md\":\"B1GhxeEk\",\"06.设计模式_12-享元模式.md\":\"AkotPE6P\",\"06.设计模式_13-观察者模式.md\":\"CesAiKIl\",\"06.设计模式_14-策略模式.md\":\"BTzGx7bJ\",\"06.设计模式_15-命令模式.md\":\"BESWRTz3\",\"06.设计模式_16-中介者模式.md\":\"DpRlU-PE\",\"06.设计模式_17-备忘录模式.md\":\"BHES4fFW\",\"06.设计模式_18-模板方法模式.md\":\"Bgj6_eqg\",\"06.设计模式_19-迭代器模式.md\":\"CkhvDRNG\",\"06.设计模式_2-工厂方法模式.md\":\"VYv1ToD5\",\"06.设计模式_20-状态模式.md\":\"a63pDKRT\",\"06.设计模式_21-责任链模式.md\":\"CMKqSQ7m\",\"06.设计模式_22-解释器模式.md\":\"DuPqro7Z\",\"06.设计模式_23-访问者模式.md\":\"CJ_7w-59\",\"06.设计模式_3-抽象工厂模式.md\":\"IBk5BVVC\",\"06.设计模式_4-建造者模式.md\":\"CJQt_iiA\",\"06.设计模式_5-原型模式.md\":\"DEWNjmPE\",\"06.设计模式_6-适配器模式.md\":\"C9ggj-uA\",\"06.设计模式_7-代理模式.md\":\"CCQwGIOG\",\"06.设计模式_8-装饰模式.md\":\"EQl7yHX3\",\"06.设计模式_9-外观模式.md\":\"DEp9HNjN\",\"07.代码人生_三十而立之年.md\":\"51XTb1x3\",\"07.代码人生_人生教训.md\":\"CJXsnMc5\",\"07.代码人生_开发注意事项.md\":\"CEicDgAi\",\"07.代码人生_改变.md\":\"Bb5eb8fL\",\"07.代码人生_每日计划.md\":\"CDIu6ibS\",\"07.代码人生_生活小技巧.md\":\"B3KjbHrj\",\"api-examples.md\":\"C4MPM3ac\",\"index.md\":\"BS9NxHIm\",\"markdown-examples.md\":\"CEd4icy5\",\"后台管理系统脚手架.md\":\"C6hujDFy\",\"面试题.md\":\"vXECt2eo\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"Java全栈知识体系\",\"description\":\"A VitePress site\",\"base\":\"/wiki/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"logo\":\"/logo.svg\",\"outline\":\"deep\",\"nav\":[{\"text\":\"后台管理系统脚手架\",\"link\":\"/后台管理系统脚手架\"},{\"text\":\"JAVA\",\"items\":[{\"text\":\"JAVA基础\",\"link\":\"/01.后端技术栈/JAVA基础\"},{\"text\":\"多线程\",\"link\":\"/01.后端技术栈/多线程/JAVA并发-理论基础\"}]},{\"text\":\"Spring全家桶\",\"items\":[{\"text\":\"Spring\",\"link\":\"/02.Spring/Spring-@Transactional事务失效的场景\"},{\"text\":\"SpringBoot\",\"link\":\"/02.Spring/SpringBoot\"}]},{\"text\":\"数据库\",\"items\":[{\"text\":\"Mysql\",\"link\":\"/03.数据库/MySql-索引\"},{\"text\":\"Redis\",\"link\":\"/03.数据库/Redis/概念和基础\"}]},{\"text\":\"中间件\",\"items\":[{\"text\":\"Kafka\",\"link\":\"/04.中间件/Kafka.md\"},{\"text\":\"Zookeeper\",\"link\":\"/04.中间件/Zookeeper.md\"},{\"text\":\"Netty\",\"link\":\"/04.中间件/Netty.md\"}]},{\"text\":\"工具|部署\",\"link\":\"/03.工具-部署/linux运维笔记\"},{\"text\":\"设计模式\",\"link\":\"/06.设计模式/0-简介\"},{\"text\":\"方法论\",\"items\":[{\"text\":\"代码规范\",\"link\":\"/04.方法论/代码规范\"}]},{\"text\":\"架构\",\"items\":[{\"text\":\"常用技术点\",\"link\":\"/05.架构/常用技术点/JWT\"},{\"text\":\"架构300讲\",\"link\":\"/05.架构/架构300讲\"}]},{\"text\":\"代码人生\",\"link\":\"/07.代码人生/生活小技巧\"}],\"sidebar\":{\"/01.后端技术栈/\":[{\"text\":\"JAVA\",\"items\":[{\"text\":\"JAVA基础One\",\"link\":\"/01.后端技术栈/JAVA基础.md\"},{\"text\":\"JAVA基础Two\",\"link\":\"/01.后端技术栈/JAVA基础2\"},{\"text\":\"网络IO\",\"link\":\"/01.后端技术栈/网络IO\"},{\"text\":\"多线程\",\"items\":[{\"text\":\"JAVA并发-理论基础\",\"link\":\"/01.后端技术栈/多线程/JAVA并发-理论基础\"},{\"text\":\"关键字：synchronized\",\"link\":\"/01.后端技术栈/多线程/关键字synchronized\"},{\"text\":\"关键字：volatile\",\"link\":\"/01.后端技术栈/多线程/关键字volatile\"},{\"text\":\"关键字：final\",\"link\":\"/01.后端技术栈/多线程/关键字final\"},{\"text\":\"JUC集合-BlockingQueue\",\"link\":\"/01.后端技术栈/多线程/JUC集合-BlockingQueue\"},{\"text\":\"JUC线程池-CompletableFuture\",\"link\":\"/01.后端技术栈/多线程/JUC线程池-CompletableFuture\"},{\"text\":\"JUC线程池-ThreadPoolExecutor\",\"link\":\"/01.后端技术栈/多线程/JUC线程池-ThreadPoolExecutor\"},{\"text\":\"JAVA并发-ThreadLocal\",\"link\":\"/01.后端技术栈/多线程/JAVA并发-ThreadLocal\"}]}]}],\"/02.Spring/\":[{\"text\":\"Spring全家桶\",\"items\":[{\"text\":\"Spring\",\"items\":[{\"text\":\"@Transactional事务失效的场景\",\"link\":\"/02.Spring/Spring-@Transactional事务失效的场景\"}]},{\"text\":\"SpringBoot\",\"link\":\"/02.Spring/SpringBoot\"}]}],\"/03.数据库/\":[{\"text\":\"数据库\",\"items\":[{\"text\":\"Mysql\",\"items\":[{\"text\":\"索引\",\"link\":\"/03.数据库/MySql-索引.md\"},{\"text\":\"事务\",\"link\":\"/03.数据库/MySql-事务\"},{\"text\":\"SQL优化\",\"link\":\"/03.数据库/MySql-SQL优化\"},{\"text\":\"主从复制的原理\",\"link\":\"/03.数据库/MySql-主从复制的原理\"},{\"text\":\"主从复制数据一致性\",\"link\":\"/03.数据库/MySql-主从复制数据一致性\"},{\"text\":\"分库分表全局ID\",\"link\":\"/03.数据库/MySql-全局ID\"},{\"text\":\"深度分页limit\",\"link\":\"/03.数据库/MySql-深度分页\"},{\"text\":\"大厂实践:美团MySQL索引原理及慢查询优化\",\"link\":\"/03.数据库/MySql-大厂实践-美团MySQL索引原理及慢查询优化\"},{\"text\":\"大厂实践:美团SQL优化工具SQLAdvisor开源\",\"link\":\"/03.数据库/MySql-大厂实践-美团SQL优化工具SQLAdvisor开源\"}]},{\"text\":\"Redis\",\"items\":[{\"text\":\"概念和基础\",\"link\":\"/03.数据库/Redis/概念和基础\"},{\"text\":\"数据结构-对象机制\",\"link\":\"/03.数据库/Redis/数据结构-对象机制\"},{\"text\":\"数据结构-底层数据结构\",\"link\":\"/03.数据库/Redis/数据结构-底层数据结构\"},{\"text\":\"数据结构-对象与编码(底层结构)\",\"link\":\"/03.数据库/Redis/数据结构-对象与编码(底层结构)\"},{\"text\":\"持久化RDB和AOF\",\"link\":\"/03.数据库/Redis/持久化RDB和AOP\"},{\"text\":\"高可用-主从复制\",\"link\":\"/03.数据库/Redis/高可用-主从复制\"},{\"text\":\"高可用-哨兵机制\",\"link\":\"/03.数据库/Redis/高可用-哨兵机制\"},{\"text\":\"性能调优\",\"link\":\"/03.数据库/Redis/性能调优\"},{\"text\":\"Redis相关问题\",\"link\":\"/03.数据库/Redis\"}]},{\"text\":\"Mysql和Redis数据一致性\",\"link\":\"/03.数据库/Mysql和Redis数据一致性\"},{\"text\":\"Kafka\",\"link\":\"/03.数据库/Kafka.md\"},{\"text\":\"Zookeeper\",\"link\":\"/03.数据库/Zookeeper.md\"},{\"text\":\"Netty\",\"link\":\"/03.数据库/Netty.md\"}]}],\"/04.中间件/\":[{\"text\":\"中间件\",\"items\":[{\"text\":\"Kafka\",\"link\":\"/04.中间件/Kafka.md\"},{\"text\":\"Zookeeper\",\"link\":\"/04.中间件/Zookeeper.md\"},{\"text\":\"Netty\",\"link\":\"/04.中间件/Netty.md\"}]}],\"/02.算法/\":[{\"text\":\"算法基础和思想\",\"items\":[{\"text\":\"数据结构基础\",\"items\":[{\"text\":\"概述\",\"link\":\"/02.算法/算法基础和思想/数据结构基础/数据结构基础概述\"},{\"text\":\"线性表-数组和矩阵\",\"link\":\"/02.算法/算法基础和思想/数据结构基础/线性表-数组和矩阵\"},{\"text\":\"线性表-链表\",\"link\":\"/02.算法/算法基础和思想/数据结构基础/线性表-链表\"}]}]}],\"/06.设计模式/\":[{\"text\":\"设计模式\",\"items\":[{\"text\":\"0-简介\",\"link\":\"/06.设计模式/0-简介\"},{\"text\":\"1-单例模式\",\"link\":\"/06.设计模式/1-单例模式\"},{\"text\":\"2-工厂方法模式\",\"link\":\"/06.设计模式/2-工厂方法模式\"},{\"text\":\"3-抽象工厂模式\",\"link\":\"/06.设计模式/3-抽象工厂模式\"},{\"text\":\"4-建造者模式\",\"link\":\"/06.设计模式/4-建造者模式\"},{\"text\":\"5-原型模式\",\"link\":\"/06.设计模式/5-原型模式\"},{\"text\":\"6-适配器模式\",\"link\":\"/06.设计模式/6-适配器模式\"},{\"text\":\"7-代理模式\",\"link\":\"/06.设计模式/7-代理模式\"},{\"text\":\"8-装饰模式\",\"link\":\"/06.设计模式/8-装饰模式\"},{\"text\":\"*9-外观模式\",\"link\":\"/06.设计模式/9-外观模式\"},{\"text\":\"10-桥接模式\",\"link\":\"/06.设计模式/10-桥接模式\"},{\"text\":\"11-组合模式\",\"link\":\"/06.设计模式/11-组合模式\"},{\"text\":\"12-享元模式\",\"link\":\"/06.设计模式/12-享元模式\"},{\"text\":\"*13-观察者模式\",\"link\":\"/06.设计模式/13-观察者模式\"},{\"text\":\"*14-策略模式\",\"link\":\"/06.设计模式/14-策略模式\"},{\"text\":\"15-命令模式\",\"link\":\"/06.设计模式/15-命令模式\"},{\"text\":\"16-中介者模式\",\"link\":\"/06.设计模式/16-中介者模式\"},{\"text\":\"17-备忘录模式\",\"link\":\"/06.设计模式/17-备忘录模式\"},{\"text\":\"18-模板方法模式\",\"link\":\"/06.设计模式/18-模板方法模式\"},{\"text\":\"19-迭代器模式\",\"link\":\"/06.设计模式/19-迭代器模式\"},{\"text\":\"20-状态模式\",\"link\":\"/06.设计模式/20-状态模式\"},{\"text\":\"*21-责任链模式\",\"link\":\"/06.设计模式/21-责任链模式\"},{\"text\":\"22-解释器模式\",\"link\":\"/06.设计模式/22-解释器模式\"},{\"text\":\"23-访问者模式\",\"link\":\"/06.设计模式/23-访问者模式\"}]}],\"/02.前端技术栈/\":[{\"text\":\"前端\",\"items\":[{\"text\":\"JavaScript\",\"link\":\"/02.前端技术栈/JavaScript\"},{\"text\":\"Html\",\"link\":\"/02.前端技术栈/Html\"}]}],\"/03.工具-部署/\":[{\"text\":\"工具|部署\",\"items\":[{\"text\":\"linux运维笔记\",\"link\":\"/03.工具-部署/linux运维笔记\"},{\"text\":\"常见单词\",\"link\":\"/03.工具-部署/常见单词\"},{\"text\":\"收藏目录\",\"link\":\"/03.工具-部署/收藏目录\"},{\"text\":\"Html\",\"link\":\"/03.工具-部署/window\"},{\"text\":\"Markdown Examples\",\"link\":\"/markdown-examples\"},{\"text\":\"Runtime API Examples\",\"link\":\"/api-examples\"}]}],\"/04.方法论/\":[{\"text\":\"方法论\",\"items\":[{\"text\":\"代码规范\",\"link\":\"/04.方法论/代码规范\"}]}],\"/05.架构/\":[{\"text\":\"架构\",\"items\":[{\"text\":\"常用技术点\",\"items\":[{\"text\":\"JWT\",\"link\":\"/05.架构/常用技术点/JWT\"},{\"text\":\"数据库读写分离\",\"link\":\"/05.架构/常用技术点/数据库读写分离\"}]},{\"text\":\"架构900讲\",\"items\":[{\"text\":\"MQ\",\"link\":\"/05.架构/架构900讲/MQ\"},{\"text\":\"Redis\",\"link\":\"/05.架构/架构900讲/Redis\"},{\"text\":\"数据库\",\"link\":\"/05.架构/架构900讲/数据库\"},{\"text\":\"数据库-MySql\",\"link\":\"/05.架构/架构900讲/数据库-MySql\"},{\"text\":\"运维\",\"link\":\"/05.架构/架构900讲/运维\"}]},{\"text\":\"架构900讲\",\"link\":\"/05.架构/架构300讲\"}]}],\"/07.代码人生/\":[{\"text\":\"代码人生\",\"items\":[{\"text\":\"生活小技巧\",\"link\":\"/07.代码人生/生活小技巧\"},{\"text\":\"每日计划\",\"link\":\"/07.代码人生/每日计划\"}]}]},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/vuejs/vitepress\"}],\"search\":{\"provider\":\"local\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false,\"additionalConfig\":{}}");</script>
    
  </body>
</html>