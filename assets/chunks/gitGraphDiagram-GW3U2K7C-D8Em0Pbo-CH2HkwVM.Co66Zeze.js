import{i as F}from"./chunk-353BL4L5-BaBLD7R4-CCFpVaw8.DIdKjcM-.js";import{e as Y}from"./chunk-AACKK3MU-DjZE3x88-CFkx3_OA.B-yyWGIa.js";import{S as h,ap as U,ao as V,a6 as J,a7 as X,a8 as Q,a9 as Z,u,m as tt,aa as et,an as rt,aA as ot,au as at,ah as E,aB as st,aC as nt,aD as ct,aE as it}from"./theme.Br3hWqGG.js";import{I as dt}from"./treemap-75Q7IDZK-Du2UP5aq-Bh4ITUZl.DU9gTvau.js";import"./framework.C19qILHO.js";import"./baseUniq-D-4w9BQh-CXDlGfTI.ChG-752p.js";import"./basePickBy-DRTm9oBc-BeRiPSDA.BfeHIJUR.js";import"./clone-pm6OfDjU-WrCLsCa7.PzODaDcC.js";var f={NORMAL:0,REVERSE:1,HIGHLIGHT:2,MERGE:3,CHERRY_PICK:4},ht=ct.gitGraph,P=h(()=>st({...ht,...nt().gitGraph}),"getConfig"),i=new Y(()=>{const e=P(),t=e.mainBranchName,a=e.mainBranchOrder;return{mainBranchName:t,commits:new Map,head:null,branchConfig:new Map([[t,{name:t,order:a}]]),branches:new Map([[t,null]]),currBranch:t,direction:"LR",seq:0,options:{}}});function O(){return it({length:7})}h(O,"getID");function D(e,t){const a=Object.create(null);return e.reduce((s,r)=>{const o=t(r);return a[o]||(a[o]=!0,s.push(r)),s},[])}h(D,"uniqBy");var mt=h(function(e){i.records.direction=e},"setDirection"),$t=h(function(e){u.debug("options str",e),e=e?.trim(),e=e||"{}";try{i.records.options=JSON.parse(e)}catch(t){u.error("error while parsing gitGraph options",t.message)}},"setOptions"),lt=h(function(){return i.records.options},"getOptions"),gt=h(function(e){let t=e.msg,a=e.id;const s=e.type;let r=e.tags;u.info("commit",t,a,s,r),u.debug("Entering commit:",t,a,s,r);const o=P();a=E.sanitizeText(a,o),t=E.sanitizeText(t,o),r=r?.map(n=>E.sanitizeText(n,o));const d={id:a||i.records.seq+"-"+O(),message:t,seq:i.records.seq++,type:s??f.NORMAL,tags:r??[],parents:i.records.head==null?[]:[i.records.head.id],branch:i.records.currBranch};i.records.head=d,u.info("main branch",o.mainBranchName),i.records.commits.has(d.id)&&u.warn(`Commit ID ${d.id} already exists`),i.records.commits.set(d.id,d),i.records.branches.set(i.records.currBranch,d.id),u.debug("in pushCommit "+d.id)},"commit"),yt=h(function(e){let t=e.name;const a=e.order;if(t=E.sanitizeText(t,P()),i.records.branches.has(t))throw new Error(`Trying to create an existing branch. (Help: Either use a new name if you want create a new branch or try using "checkout ${t}")`);i.records.branches.set(t,i.records.head!=null?i.records.head.id:null),i.records.branchConfig.set(t,{name:t,order:a}),N(t),u.debug("in createBranch")},"branch"),pt=h(e=>{let t=e.branch,a=e.id;const s=e.type,r=e.tags,o=P();t=E.sanitizeText(t,o),a&&(a=E.sanitizeText(a,o));const d=i.records.branches.get(i.records.currBranch),n=i.records.branches.get(t),l=d?i.records.commits.get(d):void 0,m=n?i.records.commits.get(n):void 0;if(l&&m&&l.branch===t)throw new Error(`Cannot merge branch '${t}' into itself.`);if(i.records.currBranch===t){const c=new Error('Incorrect usage of "merge". Cannot merge a branch to itself');throw c.hash={text:`merge ${t}`,token:`merge ${t}`,expected:["branch abc"]},c}if(l===void 0||!l){const c=new Error(`Incorrect usage of "merge". Current branch (${i.records.currBranch})has no commits`);throw c.hash={text:`merge ${t}`,token:`merge ${t}`,expected:["commit"]},c}if(!i.records.branches.has(t)){const c=new Error('Incorrect usage of "merge". Branch to be merged ('+t+") does not exist");throw c.hash={text:`merge ${t}`,token:`merge ${t}`,expected:[`branch ${t}`]},c}if(m===void 0||!m){const c=new Error('Incorrect usage of "merge". Branch to be merged ('+t+") has no commits");throw c.hash={text:`merge ${t}`,token:`merge ${t}`,expected:['"commit"']},c}if(l===m){const c=new Error('Incorrect usage of "merge". Both branches have same head');throw c.hash={text:`merge ${t}`,token:`merge ${t}`,expected:["branch abc"]},c}if(a&&i.records.commits.has(a)){const c=new Error('Incorrect usage of "merge". Commit with id:'+a+" already exists, use different custom id");throw c.hash={text:`merge ${t} ${a} ${s} ${r?.join(" ")}`,token:`merge ${t} ${a} ${s} ${r?.join(" ")}`,expected:[`merge ${t} ${a}_UNIQUE ${s} ${r?.join(" ")}`]},c}const $=n||"",g={id:a||`${i.records.seq}-${O()}`,message:`merged branch ${t} into ${i.records.currBranch}`,seq:i.records.seq++,parents:i.records.head==null?[]:[i.records.head.id,$],branch:i.records.currBranch,type:f.MERGE,customType:s,customId:!!a,tags:r??[]};i.records.head=g,i.records.commits.set(g.id,g),i.records.branches.set(i.records.currBranch,g.id),u.debug(i.records.branches),u.debug("in mergeBranch")},"merge"),ft=h(function(e){let t=e.id,a=e.targetId,s=e.tags,r=e.parent;u.debug("Entering cherryPick:",t,a,s);const o=P();if(t=E.sanitizeText(t,o),a=E.sanitizeText(a,o),s=s?.map(l=>E.sanitizeText(l,o)),r=E.sanitizeText(r,o),!t||!i.records.commits.has(t)){const l=new Error('Incorrect usage of "cherryPick". Source commit id should exist and provided');throw l.hash={text:`cherryPick ${t} ${a}`,token:`cherryPick ${t} ${a}`,expected:["cherry-pick abc"]},l}const d=i.records.commits.get(t);if(d===void 0||!d)throw new Error('Incorrect usage of "cherryPick". Source commit id should exist and provided');if(r&&!(Array.isArray(d.parents)&&d.parents.includes(r)))throw new Error("Invalid operation: The specified parent commit is not an immediate parent of the cherry-picked commit.");const n=d.branch;if(d.type===f.MERGE&&!r)throw new Error("Incorrect usage of cherry-pick: If the source commit is a merge commit, an immediate parent commit must be specified.");if(!a||!i.records.commits.has(a)){if(n===i.records.currBranch){const g=new Error('Incorrect usage of "cherryPick". Source commit is already on current branch');throw g.hash={text:`cherryPick ${t} ${a}`,token:`cherryPick ${t} ${a}`,expected:["cherry-pick abc"]},g}const l=i.records.branches.get(i.records.currBranch);if(l===void 0||!l){const g=new Error(`Incorrect usage of "cherry-pick". Current branch (${i.records.currBranch})has no commits`);throw g.hash={text:`cherryPick ${t} ${a}`,token:`cherryPick ${t} ${a}`,expected:["cherry-pick abc"]},g}const m=i.records.commits.get(l);if(m===void 0||!m){const g=new Error(`Incorrect usage of "cherry-pick". Current branch (${i.records.currBranch})has no commits`);throw g.hash={text:`cherryPick ${t} ${a}`,token:`cherryPick ${t} ${a}`,expected:["cherry-pick abc"]},g}const $={id:i.records.seq+"-"+O(),message:`cherry-picked ${d?.message} into ${i.records.currBranch}`,seq:i.records.seq++,parents:i.records.head==null?[]:[i.records.head.id,d.id],branch:i.records.currBranch,type:f.CHERRY_PICK,tags:s?s.filter(Boolean):[`cherry-pick:${d.id}${d.type===f.MERGE?`|parent:${r}`:""}`]};i.records.head=$,i.records.commits.set($.id,$),i.records.branches.set(i.records.currBranch,$.id),u.debug(i.records.branches),u.debug("in cherryPick")}},"cherryPick"),N=h(function(e){if(e=E.sanitizeText(e,P()),i.records.branches.has(e)){i.records.currBranch=e;const t=i.records.branches.get(i.records.currBranch);t===void 0||!t?i.records.head=null:i.records.head=i.records.commits.get(t)??null}else{const t=new Error(`Trying to checkout branch which is not yet created. (Help try using "branch ${e}")`);throw t.hash={text:`checkout ${e}`,token:`checkout ${e}`,expected:[`branch ${e}`]},t}},"checkout");function H(e,t,a){const s=e.indexOf(t);s===-1?e.push(a):e.splice(s,1,a)}h(H,"upsert");function z(e){const t=e.reduce((r,o)=>r.seq>o.seq?r:o,e[0]);let a="";e.forEach(function(r){r===t?a+="	*":a+="	|"});const s=[a,t.id,t.seq];for(const r in i.records.branches)i.records.branches.get(r)===t.id&&s.push(r);if(u.debug(s.join(" ")),t.parents&&t.parents.length==2&&t.parents[0]&&t.parents[1]){const r=i.records.commits.get(t.parents[0]);H(e,t,r),t.parents[1]&&e.push(i.records.commits.get(t.parents[1]))}else{if(t.parents.length==0)return;if(t.parents[0]){const r=i.records.commits.get(t.parents[0]);H(e,t,r)}}e=D(e,r=>r.id),z(e)}h(z,"prettyPrintCommitHistory");var xt=h(function(){u.debug(i.records.commits);const e=W()[0];z([e])},"prettyPrint"),ut=h(function(){i.reset(),at()},"clear"),bt=h(function(){return[...i.records.branchConfig.values()].map((e,t)=>e.order!==null&&e.order!==void 0?e:{...e,order:parseFloat(`0.${t}`)}).sort((e,t)=>(e.order??0)-(t.order??0)).map(({name:e})=>({name:e}))},"getBranchesAsObjArray"),wt=h(function(){return i.records.branches},"getBranches"),Bt=h(function(){return i.records.commits},"getCommits"),W=h(function(){const e=[...i.records.commits.values()];return e.forEach(function(t){u.debug(t.id)}),e.sort((t,a)=>t.seq-a.seq),e},"getCommitsArray"),Et=h(function(){return i.records.currBranch},"getCurrentBranch"),Ct=h(function(){return i.records.direction},"getDirection"),kt=h(function(){return i.records.head},"getHead"),j={commitType:f,getConfig:P,setDirection:mt,setOptions:$t,getOptions:lt,commit:gt,branch:yt,merge:pt,cherryPick:ft,checkout:N,prettyPrint:xt,clear:ut,getBranchesAsObjArray:bt,getBranches:wt,getCommits:Bt,getCommitsArray:W,getCurrentBranch:Et,getDirection:Ct,getHead:kt,setAccTitle:Z,getAccTitle:Q,getAccDescription:X,setAccDescription:J,setDiagramTitle:V,getDiagramTitle:U},Lt=h((e,t)=>{F(e,t),e.dir&&t.setDirection(e.dir);for(const a of e.statements)Tt(a,t)},"populate"),Tt=h((e,t)=>{const a={Commit:h(s=>t.commit(Mt(s)),"Commit"),Branch:h(s=>t.branch(vt(s)),"Branch"),Merge:h(s=>t.merge(Pt(s)),"Merge"),Checkout:h(s=>t.checkout(Rt(s)),"Checkout"),CherryPicking:h(s=>t.cherryPick(It(s)),"CherryPicking")}[e.$type];a?a(e):u.error(`Unknown statement type: ${e.$type}`)},"parseStatement"),Mt=h(e=>({id:e.id,msg:e.message??"",type:e.type!==void 0?f[e.type]:f.NORMAL,tags:e.tags??void 0}),"parseCommit"),vt=h(e=>({name:e.name,order:e.order??0}),"parseBranch"),Pt=h(e=>({branch:e.branch,id:e.id??"",type:e.type!==void 0?f[e.type]:void 0,tags:e.tags??void 0}),"parseMerge"),Rt=h(e=>e.branch,"parseCheckout"),It=h(e=>({id:e.id,targetId:"",tags:e.tags?.length===0?void 0:e.tags,parent:e.parent}),"parseCherryPicking"),At={parse:h(async e=>{const t=await dt("gitGraph",e);u.debug(t),Lt(t,j)},"parse")},Gt=tt(),B=Gt?.gitGraph,T=10,M=40,C=4,k=2,v=8,b=new Map,w=new Map,A=30,R=new Map,G=[],L=0,y="LR",Ot=h(()=>{b.clear(),w.clear(),R.clear(),L=0,G=[],y="LR"},"clear"),K=h(e=>{const t=document.createElementNS("http://www.w3.org/2000/svg","text");return(typeof e=="string"?e.split(/\\n|\n|<br\s*\/?>/gi):e).forEach(a=>{const s=document.createElementNS("http://www.w3.org/2000/svg","tspan");s.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),s.setAttribute("dy","1em"),s.setAttribute("x","0"),s.setAttribute("class","row"),s.textContent=a.trim(),t.appendChild(s)}),t},"drawText"),_=h(e=>{let t,a,s;return y==="BT"?(a=h((r,o)=>r<=o,"comparisonFunc"),s=1/0):(a=h((r,o)=>r>=o,"comparisonFunc"),s=0),e.forEach(r=>{const o=y==="TB"||y=="BT"?w.get(r)?.y:w.get(r)?.x;o!==void 0&&a(o,s)&&(t=r,s=o)}),t},"findClosestParent"),qt=h(e=>{let t="",a=1/0;return e.forEach(s=>{const r=w.get(s).y;r<=a&&(t=s,a=r)}),t||void 0},"findClosestParentBT"),Ht=h((e,t,a)=>{let s=a,r=a;const o=[];e.forEach(d=>{const n=t.get(d);if(!n)throw new Error(`Commit not found for key ${d}`);n.parents.length?(s=St(n),r=Math.max(s,r)):o.push(n),Dt(n,s)}),s=r,o.forEach(d=>{Nt(d,s,a)}),e.forEach(d=>{const n=t.get(d);if(n?.parents.length){const l=qt(n.parents);s=w.get(l).y-M,s<=r&&(r=s);const m=b.get(n.branch).pos,$=s-T;w.set(n.id,{x:m,y:$})}})},"setParallelBTPos"),zt=h(e=>{const t=_(e.parents.filter(s=>s!==null));if(!t)throw new Error(`Closest parent not found for commit ${e.id}`);const a=w.get(t)?.y;if(a===void 0)throw new Error(`Closest parent position not found for commit ${e.id}`);return a},"findClosestParentPos"),St=h(e=>zt(e)+M,"calculateCommitPosition"),Dt=h((e,t)=>{const a=b.get(e.branch);if(!a)throw new Error(`Branch not found for commit ${e.id}`);const s=a.pos,r=t+T;return w.set(e.id,{x:s,y:r}),{x:s,y:r}},"setCommitPosition"),Nt=h((e,t,a)=>{const s=b.get(e.branch);if(!s)throw new Error(`Branch not found for commit ${e.id}`);const r=t+a,o=s.pos;w.set(e.id,{x:o,y:r})},"setRootPosition"),Wt=h((e,t,a,s,r,o)=>{if(o===f.HIGHLIGHT)e.append("rect").attr("x",a.x-10).attr("y",a.y-10).attr("width",20).attr("height",20).attr("class",`commit ${t.id} commit-highlight${r%v} ${s}-outer`),e.append("rect").attr("x",a.x-6).attr("y",a.y-6).attr("width",12).attr("height",12).attr("class",`commit ${t.id} commit${r%v} ${s}-inner`);else if(o===f.CHERRY_PICK)e.append("circle").attr("cx",a.x).attr("cy",a.y).attr("r",10).attr("class",`commit ${t.id} ${s}`),e.append("circle").attr("cx",a.x-3).attr("cy",a.y+2).attr("r",2.75).attr("fill","#fff").attr("class",`commit ${t.id} ${s}`),e.append("circle").attr("cx",a.x+3).attr("cy",a.y+2).attr("r",2.75).attr("fill","#fff").attr("class",`commit ${t.id} ${s}`),e.append("line").attr("x1",a.x+3).attr("y1",a.y+1).attr("x2",a.x).attr("y2",a.y-5).attr("stroke","#fff").attr("class",`commit ${t.id} ${s}`),e.append("line").attr("x1",a.x-3).attr("y1",a.y+1).attr("x2",a.x).attr("y2",a.y-5).attr("stroke","#fff").attr("class",`commit ${t.id} ${s}`);else{const d=e.append("circle");if(d.attr("cx",a.x),d.attr("cy",a.y),d.attr("r",t.type===f.MERGE?9:10),d.attr("class",`commit ${t.id} commit${r%v}`),o===f.MERGE){const n=e.append("circle");n.attr("cx",a.x),n.attr("cy",a.y),n.attr("r",6),n.attr("class",`commit ${s} ${t.id} commit${r%v}`)}o===f.REVERSE&&e.append("path").attr("d",`M ${a.x-5},${a.y-5}L${a.x+5},${a.y+5}M${a.x-5},${a.y+5}L${a.x+5},${a.y-5}`).attr("class",`commit ${s} ${t.id} commit${r%v}`)}},"drawCommitBullet"),jt=h((e,t,a,s)=>{if(t.type!==f.CHERRY_PICK&&(t.customId&&t.type===f.MERGE||t.type!==f.MERGE)&&B?.showCommitLabel){const r=e.append("g"),o=r.insert("rect").attr("class","commit-label-bkg"),d=r.append("text").attr("x",s).attr("y",a.y+25).attr("class","commit-label").text(t.id),n=d.node()?.getBBox();if(n&&(o.attr("x",a.posWithOffset-n.width/2-k).attr("y",a.y+13.5).attr("width",n.width+2*k).attr("height",n.height+2*k),y==="TB"||y==="BT"?(o.attr("x",a.x-(n.width+4*C+5)).attr("y",a.y-12),d.attr("x",a.x-(n.width+4*C)).attr("y",a.y+n.height-12)):d.attr("x",a.posWithOffset-n.width/2),B.rotateCommitLabel))if(y==="TB"||y==="BT")d.attr("transform","rotate(-45, "+a.x+", "+a.y+")"),o.attr("transform","rotate(-45, "+a.x+", "+a.y+")");else{const l=-7.5-(n.width+10)/25*9.5,m=10+n.width/25*8.5;r.attr("transform","translate("+l+", "+m+") rotate(-45, "+s+", "+a.y+")")}}},"drawCommitLabel"),Kt=h((e,t,a,s)=>{if(t.tags.length>0){let r=0,o=0,d=0;const n=[];for(const l of t.tags.reverse()){const m=e.insert("polygon"),$=e.append("circle"),g=e.append("text").attr("y",a.y-16-r).attr("class","tag-label").text(l),c=g.node()?.getBBox();if(!c)throw new Error("Tag bbox not found");o=Math.max(o,c.width),d=Math.max(d,c.height),g.attr("x",a.posWithOffset-c.width/2),n.push({tag:g,hole:$,rect:m,yOffset:r}),r+=20}for(const{tag:l,hole:m,rect:$,yOffset:g}of n){const c=d/2,x=a.y-19.2-g;if($.attr("class","tag-label-bkg").attr("points",`
      ${s-o/2-C/2},${x+k}  
      ${s-o/2-C/2},${x-k}
      ${a.posWithOffset-o/2-C},${x-c-k}
      ${a.posWithOffset+o/2+C},${x-c-k}
      ${a.posWithOffset+o/2+C},${x+c+k}
      ${a.posWithOffset-o/2-C},${x+c+k}`),m.attr("cy",x).attr("cx",s-o/2+C/2).attr("r",1.5).attr("class","tag-hole"),y==="TB"||y==="BT"){const p=s+g;$.attr("class","tag-label-bkg").attr("points",`
        ${a.x},${p+2}
        ${a.x},${p-2}
        ${a.x+T},${p-c-2}
        ${a.x+T+o+4},${p-c-2}
        ${a.x+T+o+4},${p+c+2}
        ${a.x+T},${p+c+2}`).attr("transform","translate(12,12) rotate(45, "+a.x+","+s+")"),m.attr("cx",a.x+C/2).attr("cy",p).attr("transform","translate(12,12) rotate(45, "+a.x+","+s+")"),l.attr("x",a.x+5).attr("y",p+3).attr("transform","translate(14,14) rotate(45, "+a.x+","+s+")")}}}},"drawCommitTags"),_t=h(e=>{switch(e.customType??e.type){case f.NORMAL:return"commit-normal";case f.REVERSE:return"commit-reverse";case f.HIGHLIGHT:return"commit-highlight";case f.MERGE:return"commit-merge";case f.CHERRY_PICK:return"commit-cherry-pick";default:return"commit-normal"}},"getCommitClassType"),Ft=h((e,t,a,s)=>{const r={x:0,y:0};if(e.parents.length>0){const o=_(e.parents);if(o){const d=s.get(o)??r;return t==="TB"?d.y+M:t==="BT"?(s.get(e.id)??r).y-M:d.x+M}}else return t==="TB"?A:t==="BT"?(s.get(e.id)??r).y-M:0;return 0},"calculatePosition"),Yt=h((e,t,a)=>{const s=y==="BT"&&a?t:t+T,r=y==="TB"||y==="BT"?s:b.get(e.branch)?.pos,o=y==="TB"||y==="BT"?b.get(e.branch)?.pos:s;if(o===void 0||r===void 0)throw new Error(`Position were undefined for commit ${e.id}`);return{x:o,y:r,posWithOffset:s}},"getCommitPosition"),S=h((e,t,a)=>{if(!B)throw new Error("GitGraph config not found");const s=e.append("g").attr("class","commit-bullets"),r=e.append("g").attr("class","commit-labels");let o=y==="TB"||y==="BT"?A:0;const d=[...t.keys()],n=B?.parallelCommits??!1,l=h(($,g)=>{const c=t.get($)?.seq,x=t.get(g)?.seq;return c!==void 0&&x!==void 0?c-x:0},"sortKeys");let m=d.sort(l);y==="BT"&&(n&&Ht(m,t,o),m=m.reverse()),m.forEach($=>{const g=t.get($);if(!g)throw new Error(`Commit not found for key ${$}`);n&&(o=Ft(g,y,o,w));const c=Yt(g,o,n);if(a){const x=_t(g),p=g.customType??g.type,q=b.get(g.branch)?.index??0;Wt(s,g,c,x,q,p),jt(r,g,c,o),Kt(r,g,c,o)}y==="TB"||y==="BT"?w.set(g.id,{x:c.x,y:c.posWithOffset}):w.set(g.id,{x:c.posWithOffset,y:c.y}),o=y==="BT"&&n?o+M:o+M+T,o>L&&(L=o)})},"drawCommits"),Ut=h((e,t,a,s,r)=>{const o=(y==="TB"||y==="BT"?a.x<s.x:a.y<s.y)?t.branch:e.branch,d=h(l=>l.branch===o,"isOnBranchToGetCurve"),n=h(l=>l.seq>e.seq&&l.seq<t.seq,"isBetweenCommits");return[...r.values()].some(l=>n(l)&&d(l))},"shouldRerouteArrow"),I=h((e,t,a=0)=>{const s=e+Math.abs(e-t)/2;if(a>5)return s;if(G.every(o=>Math.abs(o-s)>=10))return G.push(s),s;const r=Math.abs(e-t);return I(e,t-r/5,a+1)},"findLane"),Vt=h((e,t,a,s)=>{const r=w.get(t.id),o=w.get(a.id);if(r===void 0||o===void 0)throw new Error(`Commit positions not found for commits ${t.id} and ${a.id}`);const d=Ut(t,a,r,o,s);let n="",l="",m=0,$=0,g=b.get(a.branch)?.index;a.type===f.MERGE&&t.id!==a.parents[0]&&(g=b.get(t.branch)?.index);let c;if(d){n="A 10 10, 0, 0, 0,",l="A 10 10, 0, 0, 1,",m=10,$=10;const x=r.y<o.y?I(r.y,o.y):I(o.y,r.y),p=r.x<o.x?I(r.x,o.x):I(o.x,r.x);y==="TB"?r.x<o.x?c=`M ${r.x} ${r.y} L ${p-m} ${r.y} ${l} ${p} ${r.y+$} L ${p} ${o.y-m} ${n} ${p+$} ${o.y} L ${o.x} ${o.y}`:(g=b.get(t.branch)?.index,c=`M ${r.x} ${r.y} L ${p+m} ${r.y} ${n} ${p} ${r.y+$} L ${p} ${o.y-m} ${l} ${p-$} ${o.y} L ${o.x} ${o.y}`):y==="BT"?r.x<o.x?c=`M ${r.x} ${r.y} L ${p-m} ${r.y} ${n} ${p} ${r.y-$} L ${p} ${o.y+m} ${l} ${p+$} ${o.y} L ${o.x} ${o.y}`:(g=b.get(t.branch)?.index,c=`M ${r.x} ${r.y} L ${p+m} ${r.y} ${l} ${p} ${r.y-$} L ${p} ${o.y+m} ${n} ${p-$} ${o.y} L ${o.x} ${o.y}`):r.y<o.y?c=`M ${r.x} ${r.y} L ${r.x} ${x-m} ${n} ${r.x+$} ${x} L ${o.x-m} ${x} ${l} ${o.x} ${x+$} L ${o.x} ${o.y}`:(g=b.get(t.branch)?.index,c=`M ${r.x} ${r.y} L ${r.x} ${x+m} ${l} ${r.x+$} ${x} L ${o.x-m} ${x} ${n} ${o.x} ${x-$} L ${o.x} ${o.y}`)}else n="A 20 20, 0, 0, 0,",l="A 20 20, 0, 0, 1,",m=20,$=20,y==="TB"?(r.x<o.x&&(a.type===f.MERGE&&t.id!==a.parents[0]?c=`M ${r.x} ${r.y} L ${r.x} ${o.y-m} ${n} ${r.x+$} ${o.y} L ${o.x} ${o.y}`:c=`M ${r.x} ${r.y} L ${o.x-m} ${r.y} ${l} ${o.x} ${r.y+$} L ${o.x} ${o.y}`),r.x>o.x&&(n="A 20 20, 0, 0, 0,",l="A 20 20, 0, 0, 1,",m=20,$=20,a.type===f.MERGE&&t.id!==a.parents[0]?c=`M ${r.x} ${r.y} L ${r.x} ${o.y-m} ${l} ${r.x-$} ${o.y} L ${o.x} ${o.y}`:c=`M ${r.x} ${r.y} L ${o.x+m} ${r.y} ${n} ${o.x} ${r.y+$} L ${o.x} ${o.y}`),r.x===o.x&&(c=`M ${r.x} ${r.y} L ${o.x} ${o.y}`)):y==="BT"?(r.x<o.x&&(a.type===f.MERGE&&t.id!==a.parents[0]?c=`M ${r.x} ${r.y} L ${r.x} ${o.y+m} ${l} ${r.x+$} ${o.y} L ${o.x} ${o.y}`:c=`M ${r.x} ${r.y} L ${o.x-m} ${r.y} ${n} ${o.x} ${r.y-$} L ${o.x} ${o.y}`),r.x>o.x&&(n="A 20 20, 0, 0, 0,",l="A 20 20, 0, 0, 1,",m=20,$=20,a.type===f.MERGE&&t.id!==a.parents[0]?c=`M ${r.x} ${r.y} L ${r.x} ${o.y+m} ${n} ${r.x-$} ${o.y} L ${o.x} ${o.y}`:c=`M ${r.x} ${r.y} L ${o.x-m} ${r.y} ${n} ${o.x} ${r.y-$} L ${o.x} ${o.y}`),r.x===o.x&&(c=`M ${r.x} ${r.y} L ${o.x} ${o.y}`)):(r.y<o.y&&(a.type===f.MERGE&&t.id!==a.parents[0]?c=`M ${r.x} ${r.y} L ${o.x-m} ${r.y} ${l} ${o.x} ${r.y+$} L ${o.x} ${o.y}`:c=`M ${r.x} ${r.y} L ${r.x} ${o.y-m} ${n} ${r.x+$} ${o.y} L ${o.x} ${o.y}`),r.y>o.y&&(a.type===f.MERGE&&t.id!==a.parents[0]?c=`M ${r.x} ${r.y} L ${o.x-m} ${r.y} ${n} ${o.x} ${r.y-$} L ${o.x} ${o.y}`:c=`M ${r.x} ${r.y} L ${r.x} ${o.y+m} ${l} ${r.x+$} ${o.y} L ${o.x} ${o.y}`),r.y===o.y&&(c=`M ${r.x} ${r.y} L ${o.x} ${o.y}`));if(c===void 0)throw new Error("Line definition not found");e.append("path").attr("d",c).attr("class","arrow arrow"+g%v)},"drawArrow"),Jt=h((e,t)=>{const a=e.append("g").attr("class","commit-arrows");[...t.keys()].forEach(s=>{const r=t.get(s);r.parents&&r.parents.length>0&&r.parents.forEach(o=>{Vt(a,t.get(o),r,t)})})},"drawArrows"),Xt=h((e,t)=>{const a=e.append("g");t.forEach((s,r)=>{const o=r%v,d=b.get(s.name)?.pos;if(d===void 0)throw new Error(`Position not found for branch ${s.name}`);const n=a.append("line");n.attr("x1",0),n.attr("y1",d),n.attr("x2",L),n.attr("y2",d),n.attr("class","branch branch"+o),y==="TB"?(n.attr("y1",A),n.attr("x1",d),n.attr("y2",L),n.attr("x2",d)):y==="BT"&&(n.attr("y1",L),n.attr("x1",d),n.attr("y2",A),n.attr("x2",d)),G.push(d);const l=s.name,m=K(l),$=a.insert("rect"),g=a.insert("g").attr("class","branchLabel").insert("g").attr("class","label branch-label"+o);g.node().appendChild(m);const c=m.getBBox();$.attr("class","branchLabelBkg label"+o).attr("rx",4).attr("ry",4).attr("x",-c.width-4-(B?.rotateCommitLabel===!0?30:0)).attr("y",-c.height/2+8).attr("width",c.width+18).attr("height",c.height+4),g.attr("transform","translate("+(-c.width-14-(B?.rotateCommitLabel===!0?30:0))+", "+(d-c.height/2-1)+")"),y==="TB"?($.attr("x",d-c.width/2-10).attr("y",0),g.attr("transform","translate("+(d-c.width/2-5)+", 0)")):y==="BT"?($.attr("x",d-c.width/2-10).attr("y",L),g.attr("transform","translate("+(d-c.width/2-5)+", "+L+")")):$.attr("transform","translate(-19, "+(d-c.height/2)+")")})},"drawBranches"),Qt=h(function(e,t,a,s,r){return b.set(e,{pos:t,index:a}),t+=50+(r?40:0)+(y==="TB"||y==="BT"?s.width/2:0),t},"setBranchPosition"),Zt=h(function(e,t,a,s){if(Ot(),u.debug("in gitgraph renderer",e+`
`,"id:",t,a),!B)throw new Error("GitGraph config not found");const r=B.rotateCommitLabel??!1,o=s.db;R=o.getCommits();const d=o.getBranchesAsObjArray();y=o.getDirection();const n=et(`[id="${t}"]`);let l=0;d.forEach((m,$)=>{const g=K(m.name),c=n.append("g"),x=c.insert("g").attr("class","branchLabel"),p=x.insert("g").attr("class","label branch-label");p.node()?.appendChild(g);const q=g.getBBox();l=Qt(m.name,l,$,q,r),p.remove(),x.remove(),c.remove()}),S(n,R,!1),B.showBranches&&Xt(n,d),Jt(n,R),S(n,R,!0),rt.insertTitle(n,"gitTitleText",B.titleTopMargin??0,o.getDiagramTitle()),ot(void 0,n,B.diagramPadding,B.useMaxWidth)},"draw"),te={draw:Zt},ee=h(e=>`
  .commit-id,
  .commit-msg,
  .branch-label {
    fill: lightgrey;
    color: lightgrey;
    font-family: 'trebuchet ms', verdana, arial, sans-serif;
    font-family: var(--mermaid-font-family);
  }
  ${[0,1,2,3,4,5,6,7].map(t=>`
        .branch-label${t} { fill: ${e["gitBranchLabel"+t]}; }
        .commit${t} { stroke: ${e["git"+t]}; fill: ${e["git"+t]}; }
        .commit-highlight${t} { stroke: ${e["gitInv"+t]}; fill: ${e["gitInv"+t]}; }
        .label${t}  { fill: ${e["git"+t]}; }
        .arrow${t} { stroke: ${e["git"+t]}; }
        `).join(`
`)}

  .branch {
    stroke-width: 1;
    stroke: ${e.lineColor};
    stroke-dasharray: 2;
  }
  .commit-label { font-size: ${e.commitLabelFontSize}; fill: ${e.commitLabelColor};}
  .commit-label-bkg { font-size: ${e.commitLabelFontSize}; fill: ${e.commitLabelBackground}; opacity: 0.5; }
  .tag-label { font-size: ${e.tagLabelFontSize}; fill: ${e.tagLabelColor};}
  .tag-label-bkg { fill: ${e.tagLabelBackground}; stroke: ${e.tagLabelBorder}; }
  .tag-hole { fill: ${e.textColor}; }

  .commit-merge {
    stroke: ${e.primaryColor};
    fill: ${e.primaryColor};
  }
  .commit-reverse {
    stroke: ${e.primaryColor};
    fill: ${e.primaryColor};
    stroke-width: 3;
  }
  .commit-highlight-outer {
  }
  .commit-highlight-inner {
    stroke: ${e.primaryColor};
    fill: ${e.primaryColor};
  }

  .arrow { stroke-width: 8; stroke-linecap: round; fill: none}
  .gitTitleText {
    text-anchor: middle;
    font-size: 18px;
    fill: ${e.textColor};
  }
`,"getStyles"),re=ee,me={parser:At,db:j,renderer:te,styles:re};export{me as diagram};
